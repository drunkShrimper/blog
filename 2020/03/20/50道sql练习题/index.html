<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>50道sql练习题 | 今天你进步了吗</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="SQL,Oracle,数据库">
    <meta name="description" content="在网上找的50道SQL练习（使用Oracle）数据表创建 学生表 Student  12345678910111213create table Student(SId varchar(10),Sname varchar(10),Sage date,Ssex varchar(10));insert into Student values(&apos;01&apos; , &apos;赵雷&apos; , to_date(&apos;1990-01-">
<meta name="keywords" content="SQL,Oracle,数据库">
<meta property="og:type" content="article">
<meta property="og:title" content="50道sql练习题">
<meta property="og:url" content="http://lipan.fun/2020/03/20/50道sql练习题/index.html">
<meta property="og:site_name" content="今天你进步了吗">
<meta property="og:description" content="在网上找的50道SQL练习（使用Oracle）数据表创建 学生表 Student  12345678910111213create table Student(SId varchar(10),Sname varchar(10),Sage date,Ssex varchar(10));insert into Student values(&apos;01&apos; , &apos;赵雷&apos; , to_date(&apos;1990-01-">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2020-04-07T03:14:27.203Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="50道sql练习题">
<meta name="twitter:description" content="在网上找的50道SQL练习（使用Oracle）数据表创建 学生表 Student  12345678910111213create table Student(SId varchar(10),Sname varchar(10),Sage date,Ssex varchar(10));insert into Student values(&apos;01&apos; , &apos;赵雷&apos; , to_date(&apos;1990-01-">
    
        <link rel="alternate" type="application/atom+xml" title="今天你进步了吗" href="/atom.xml">
    
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="/css/style.css?v=1.7.2">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/morty.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">lipan</h5>
          <a href="mailto:lipan_private@163.com" title="lipan_private@163.com" class="mail">lipan_private@163.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-book"></i>
                分类
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                标签
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                时间轴
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/drunkShrimper" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/resume"  >
                <i class="icon icon-lg icon-user"></i>
                简历
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">50道sql练习题</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">50道sql练习题</h1>
        <h5 class="subtitle">
            
                <time datetime="2020-03-20T15:51:36.000Z" itemprop="datePublished" class="page-time">
  2020-03-20
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/数据库/">数据库</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    

<article id="post-50道sql练习题"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">50道sql练习题</h1>
        <div class="post-meta">
            <time class="post-time" title="2020-03-20 23:51:36" datetime="2020-03-20T15:51:36.000Z"  itemprop="datePublished">2020-03-20</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/数据库/">数据库</a></li></ul>



            

        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h1 id="在网上找的50道SQL练习（使用Oracle）"><a href="#在网上找的50道SQL练习（使用Oracle）" class="headerlink" title="在网上找的50道SQL练习（使用Oracle）"></a>在网上找的50道SQL练习（使用Oracle）</h1><h1 id="数据表创建"><a href="#数据表创建" class="headerlink" title="数据表创建"></a>数据表创建</h1><ol>
<li>学生表 Student</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> Student(<span class="keyword">SId</span> <span class="built_in">varchar</span>(<span class="number">10</span>),Sname <span class="built_in">varchar</span>(<span class="number">10</span>),Sage <span class="built_in">date</span>,Ssex <span class="built_in">varchar</span>(<span class="number">10</span>));</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Student <span class="keyword">values</span>(<span class="string">'01'</span> , <span class="string">'赵雷'</span> , <span class="keyword">to_date</span>(<span class="string">'1990-01-01'</span>,<span class="string">'yyyy-MM-dd'</span>) , <span class="string">'男'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Student <span class="keyword">values</span>(<span class="string">'02'</span> , <span class="string">'钱电'</span> , <span class="keyword">to_date</span>(<span class="string">'1990-12-21'</span>,<span class="string">'yyyy-MM-dd'</span>) , <span class="string">'男'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Student <span class="keyword">values</span>(<span class="string">'03'</span> , <span class="string">'孙风'</span> , <span class="keyword">to_date</span>(<span class="string">'1990-12-20'</span>,<span class="string">'yyyy-MM-dd'</span>) , <span class="string">'男'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Student <span class="keyword">values</span>(<span class="string">'04'</span> , <span class="string">'李云'</span> , <span class="keyword">to_date</span>(<span class="string">'1990-12-06'</span>,<span class="string">'yyyy-MM-dd'</span>) , <span class="string">'男'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Student <span class="keyword">values</span>(<span class="string">'05'</span> , <span class="string">'周梅'</span> , <span class="keyword">to_date</span>(<span class="string">'1991-12-01'</span>,<span class="string">'yyyy-MM-dd'</span>) , <span class="string">'女'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Student <span class="keyword">values</span>(<span class="string">'06'</span> , <span class="string">'吴兰'</span> , <span class="keyword">to_date</span>(<span class="string">'1992-01-01'</span>,<span class="string">'yyyy-MM-dd'</span>) , <span class="string">'女'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Student <span class="keyword">values</span>(<span class="string">'07'</span> , <span class="string">'郑竹'</span> , <span class="keyword">to_date</span>(<span class="string">'1989-01-01'</span>,<span class="string">'yyyy-MM-dd'</span>) , <span class="string">'女'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Student <span class="keyword">values</span>(<span class="string">'09'</span> , <span class="string">'张三'</span> , <span class="keyword">to_date</span>(<span class="string">'2017-12-20'</span>,<span class="string">'yyyy-MM-dd'</span>) , <span class="string">'女'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Student <span class="keyword">values</span>(<span class="string">'10'</span> , <span class="string">'李四'</span> , <span class="keyword">to_date</span>(<span class="string">'2017-12-25'</span>,<span class="string">'yyyy-MM-dd'</span>) , <span class="string">'女'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Student <span class="keyword">values</span>(<span class="string">'11'</span> , <span class="string">'李四'</span> , <span class="keyword">to_date</span>(<span class="string">'2012-06-06'</span>,<span class="string">'yyyy-MM-dd'</span>) , <span class="string">'女'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Student <span class="keyword">values</span>(<span class="string">'12'</span> , <span class="string">'赵六'</span> , <span class="keyword">to_date</span>(<span class="string">'2013-06-13'</span>,<span class="string">'yyyy-MM-dd'</span>) , <span class="string">'女'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Student <span class="keyword">values</span>(<span class="string">'13'</span> , <span class="string">'孙七'</span> , <span class="keyword">to_date</span>(<span class="string">'2014-06-01'</span>,<span class="string">'yyyy-MM-dd'</span>) , <span class="string">'女'</span>);</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>科目表 Course</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> Course(CId <span class="built_in">varchar</span>(<span class="number">10</span>),Cname <span class="built_in">varchar</span>(<span class="number">10</span>),TId <span class="built_in">varchar</span>(<span class="number">10</span>));</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Course <span class="keyword">values</span>(<span class="string">'01'</span> , <span class="string">'语文'</span> , <span class="string">'02'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Course <span class="keyword">values</span>(<span class="string">'02'</span> , <span class="string">'数学'</span> , <span class="string">'01'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Course <span class="keyword">values</span>(<span class="string">'03'</span> , <span class="string">'英语'</span> , <span class="string">'03'</span>);</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>教师表 Teacher</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> Teacher(TId <span class="built_in">varchar</span>(<span class="number">10</span>),Tname <span class="built_in">varchar</span>(<span class="number">10</span>));</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Teacher <span class="keyword">values</span>(<span class="string">'01'</span> , <span class="string">'张三'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Teacher <span class="keyword">values</span>(<span class="string">'02'</span> , <span class="string">'李四'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Teacher <span class="keyword">values</span>(<span class="string">'03'</span> , <span class="string">'王五'</span>);</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>成绩表 SC</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> SC(<span class="keyword">SId</span> <span class="built_in">varchar</span>(<span class="number">10</span>),CId <span class="built_in">varchar</span>(<span class="number">10</span>),score <span class="built_in">decimal</span>(<span class="number">18</span>,<span class="number">1</span>));</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> SC <span class="keyword">values</span>(<span class="string">'01'</span> , <span class="string">'01'</span> , <span class="number">80</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> SC <span class="keyword">values</span>(<span class="string">'01'</span> , <span class="string">'02'</span> , <span class="number">90</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> SC <span class="keyword">values</span>(<span class="string">'01'</span> , <span class="string">'03'</span> , <span class="number">99</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> SC <span class="keyword">values</span>(<span class="string">'02'</span> , <span class="string">'01'</span> , <span class="number">70</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> SC <span class="keyword">values</span>(<span class="string">'02'</span> , <span class="string">'02'</span> , <span class="number">60</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> SC <span class="keyword">values</span>(<span class="string">'02'</span> , <span class="string">'03'</span> , <span class="number">80</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> SC <span class="keyword">values</span>(<span class="string">'03'</span> , <span class="string">'01'</span> , <span class="number">80</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> SC <span class="keyword">values</span>(<span class="string">'03'</span> , <span class="string">'02'</span> , <span class="number">80</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> SC <span class="keyword">values</span>(<span class="string">'03'</span> , <span class="string">'03'</span> , <span class="number">80</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> SC <span class="keyword">values</span>(<span class="string">'04'</span> , <span class="string">'01'</span> , <span class="number">50</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> SC <span class="keyword">values</span>(<span class="string">'04'</span> , <span class="string">'02'</span> , <span class="number">30</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> SC <span class="keyword">values</span>(<span class="string">'04'</span> , <span class="string">'03'</span> , <span class="number">20</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> SC <span class="keyword">values</span>(<span class="string">'05'</span> , <span class="string">'01'</span> , <span class="number">76</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> SC <span class="keyword">values</span>(<span class="string">'05'</span> , <span class="string">'02'</span> , <span class="number">87</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> SC <span class="keyword">values</span>(<span class="string">'06'</span> , <span class="string">'01'</span> , <span class="number">31</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> SC <span class="keyword">values</span>(<span class="string">'06'</span> , <span class="string">'03'</span> , <span class="number">34</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> SC <span class="keyword">values</span>(<span class="string">'07'</span> , <span class="string">'02'</span> , <span class="number">89</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> SC <span class="keyword">values</span>(<span class="string">'07'</span> , <span class="string">'03'</span> , <span class="number">98</span>);</span><br></pre></td></tr></table></figure>

<h1 id="练习题目"><a href="#练习题目" class="headerlink" title="练习题目"></a>练习题目</h1><h2 id="题组1"><a href="#题组1" class="headerlink" title="题组1"></a>题组1</h2><h3 id="题型1"><a href="#题型1" class="headerlink" title="题型1"></a>题型1</h3><ol>
<li>查询” 01 “课程比” 02 “课程成绩高的学生的信息及课程分数</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> t1.*,t2.score 课程<span class="number">02</span>分数 <span class="keyword">from</span> </span><br><span class="line">(<span class="keyword">select</span> * <span class="keyword">from</span> SC <span class="keyword">natural</span> <span class="keyword">join</span> student <span class="keyword">where</span> sc.cid = <span class="string">'01'</span>) t1, </span><br><span class="line">(<span class="keyword">select</span> * <span class="keyword">from</span> SC <span class="keyword">natural</span> <span class="keyword">join</span> student <span class="keyword">where</span> sc.cid = <span class="string">'02'</span>) t2</span><br><span class="line"><span class="keyword">where</span> t1.score &gt; t2.score <span class="keyword">and</span> t1.sid = t2.sid;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>查询同时存在” 01 “课程和” 02 “课程的情况</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> t1.*,t2.score 课程<span class="number">02</span>分数 <span class="keyword">from</span> </span><br><span class="line">(<span class="keyword">select</span> * <span class="keyword">from</span> SC <span class="keyword">natural</span> <span class="keyword">join</span> student <span class="keyword">where</span> sc.cid = <span class="string">'01'</span>) t1, </span><br><span class="line">(<span class="keyword">select</span> * <span class="keyword">from</span> SC <span class="keyword">natural</span> <span class="keyword">join</span> student <span class="keyword">where</span> sc.cid = <span class="string">'02'</span>) t2</span><br><span class="line"><span class="keyword">where</span> t1.sid = t2.sid;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>查询存在” 01 “课程但可能不存在” 02 “课程的情况(不存在时显示为 null )</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> t1.*,t2.score 课程<span class="number">02</span>分数 <span class="keyword">from</span> </span><br><span class="line">(<span class="keyword">select</span> * <span class="keyword">from</span> SC <span class="keyword">natural</span> <span class="keyword">join</span> student <span class="keyword">where</span> sc.cid = <span class="string">'01'</span>) t1 <span class="keyword">left</span> <span class="keyword">join</span></span><br><span class="line">(<span class="keyword">select</span> * <span class="keyword">from</span> SC <span class="keyword">natural</span> <span class="keyword">join</span> student <span class="keyword">where</span> sc.cid = <span class="string">'02'</span>) t2</span><br><span class="line"><span class="keyword">on</span> t1.sid = t2.sid;</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>查询不存在” 01 “课程但存在” 02 “课程的情况</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> </span><br><span class="line">(<span class="keyword">select</span> * <span class="keyword">from</span> SC <span class="keyword">natural</span> <span class="keyword">join</span> student <span class="keyword">where</span> sc.cid = <span class="string">'02'</span>)  <span class="keyword">where</span> <span class="keyword">sid</span> <span class="keyword">not</span> <span class="keyword">in</span></span><br><span class="line">(<span class="keyword">select</span> <span class="keyword">sid</span> <span class="keyword">from</span> SC <span class="keyword">where</span> cid = <span class="string">'01'</span>) ;</span><br></pre></td></tr></table></figure>

<h3 id="题型2"><a href="#题型2" class="headerlink" title="题型2"></a>题型2</h3><ol>
<li>查询平均成绩大于等于 60 分的同学的学生编号和学生姓名和平均成绩</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> s.sid,s.sname,t.avg_score <span class="keyword">from</span> </span><br><span class="line">  student s,</span><br><span class="line">  (<span class="keyword">select</span> <span class="keyword">sid</span>,<span class="keyword">avg</span>(score) avg_score <span class="keyword">from</span> SC <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">sid</span>) t </span><br><span class="line"><span class="keyword">where</span> s.sid = t.sid <span class="keyword">and</span> t.avg_score&gt;<span class="number">60</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> s.sid,s.sname,t.avg_score <span class="keyword">from</span> </span><br><span class="line">  student s,</span><br><span class="line">  (<span class="keyword">select</span> <span class="keyword">sid</span>,<span class="keyword">avg</span>(score) avg_score <span class="keyword">from</span> SC <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">sid</span> <span class="keyword">having</span> <span class="keyword">avg</span>(score)&gt;<span class="number">60</span>) t</span><br><span class="line"><span class="keyword">where</span> s.sid = t.sid;</span><br></pre></td></tr></table></figure>

<h3 id="题型3"><a href="#题型3" class="headerlink" title="题型3"></a>题型3</h3><ol>
<li>查询在 SC 表存在成绩的学生信息</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> student <span class="keyword">where</span> <span class="keyword">sid</span> <span class="keyword">in</span> (<span class="keyword">select</span> <span class="keyword">distinct</span> <span class="keyword">sid</span> <span class="keyword">from</span> SC);</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">DISTINCT</span> student.* <span class="keyword">from</span> student,sc <span class="keyword">where</span> student.SId=sc.SId;</span><br></pre></td></tr></table></figure>

<h3 id="题型4"><a href="#题型4" class="headerlink" title="题型4"></a>题型4</h3><ol>
<li>查询所有同学的学生编号、学生姓名、选课总数、所有课程的总成绩(没成绩的显示为 null )</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> s.sid,s.sname,t.count_course,t.sum_score <span class="keyword">from</span> </span><br><span class="line">student s, </span><br><span class="line">(<span class="keyword">select</span> <span class="keyword">sid</span>,<span class="keyword">count</span>(cid) count_course,<span class="keyword">sum</span>(score) sum_score <span class="keyword">from</span> SC <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">sid</span>) t </span><br><span class="line"><span class="keyword">where</span> s.sid = t.sid;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> s.sid,s.sname,t.count_course,t.sum_score <span class="keyword">from</span> </span><br><span class="line">student s </span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> </span><br><span class="line">(<span class="keyword">select</span> <span class="keyword">sid</span>,<span class="keyword">count</span>(cid) count_course,<span class="keyword">sum</span>(score) sum_score <span class="keyword">from</span> SC <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">sid</span>) t </span><br><span class="line"><span class="keyword">on</span> s.sid = t.sid;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>查有成绩的学生信息</li>
</ol>
<p><strong>这里涉及到一个知识点：当表2的记录数量非常大的时候，选用exists比in要高效很多</strong></p>
<blockquote>
<p>EXISTS用于检查子查询是否至少会返回一行数据，该子查询实际上并不返回任何数据，而是返回值True或False.<br>结论：IN()适合B表比A表数据小的情况<br>结论：EXISTS()适合B表比A表数据大的情况</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> student <span class="keyword">where</span> <span class="keyword">sid</span> <span class="keyword">in</span> (<span class="keyword">select</span> <span class="keyword">distinct</span> <span class="keyword">sid</span> <span class="keyword">from</span> SC);</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> student </span><br><span class="line"><span class="keyword">where</span> <span class="keyword">exists</span> (<span class="keyword">select</span> sc.sid <span class="keyword">from</span> sc <span class="keyword">where</span> student.sid = sc.sid);</span><br></pre></td></tr></table></figure>

<h3 id="题型5"><a href="#题型5" class="headerlink" title="题型5"></a>题型5</h3><ol>
<li>查询「李」姓老师的数量</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">from</span> teacher <span class="keyword">where</span> tname <span class="keyword">like</span> <span class="string">'李_%'</span>;</span><br></pre></td></tr></table></figure>

<h3 id="题型6"><a href="#题型6" class="headerlink" title="题型6"></a>题型6</h3><ol>
<li>查询学过「张三」老师授课的同学的信息</li>
</ol>
<p>先上一种笨方法</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> student <span class="keyword">where</span> <span class="keyword">sid</span> <span class="keyword">in</span> </span><br><span class="line">	(<span class="keyword">select</span> <span class="keyword">sid</span> <span class="keyword">from</span> sc <span class="keyword">where</span> cid =  </span><br><span class="line">     ( <span class="keyword">select</span> cid <span class="keyword">from</span> course <span class="keyword">where</span> tid = </span><br><span class="line">      (<span class="keyword">select</span> tid <span class="keyword">from</span> teacher <span class="keyword">where</span> tname = <span class="string">'张三'</span>)));</span><br></pre></td></tr></table></figure>

<p>下面的方法一开始理解起来有些困难，但这是很普通的<strong>多表联查</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> student.* <span class="keyword">from</span> student,teacher,course,sc</span><br><span class="line"><span class="keyword">where</span> </span><br><span class="line">    student.sid = sc.sid </span><br><span class="line">    <span class="keyword">and</span> course.cid=sc.cid </span><br><span class="line">    <span class="keyword">and</span> course.tid = teacher.tid </span><br><span class="line">    <span class="keyword">and</span> tname = <span class="string">'张三'</span>;</span><br></pre></td></tr></table></figure>

<h3 id="题型7"><a href="#题型7" class="headerlink" title="题型7"></a>题型7</h3><ol>
<li>查询没有学全所有课程的同学的信息</li>
</ol>
<p>第一种做法<strong>忽略了有的学生一门课都没学</strong>的情况（所以其sid不会出现在SC表）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> student </span><br><span class="line"><span class="keyword">where</span> <span class="keyword">sid</span>  <span class="keyword">in</span> </span><br><span class="line">(<span class="keyword">select</span> <span class="keyword">sid</span> <span class="keyword">from</span> sc <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">sid</span> <span class="keyword">having</span> <span class="keyword">count</span>(cid) &lt;(<span class="keyword">select</span> <span class="keyword">count</span>(cid) <span class="keyword">from</span> course));</span><br></pre></td></tr></table></figure>

<p>正确的做法应该是先查出修了所有课程的学生，再求其相对于所有学生集的补集</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> student</span><br><span class="line"><span class="keyword">where</span> student.sid <span class="keyword">not</span> <span class="keyword">in</span> (</span><br><span class="line">  <span class="keyword">select</span> sc.sid <span class="keyword">from</span> sc</span><br><span class="line">  <span class="keyword">group</span> <span class="keyword">by</span> sc.sid</span><br><span class="line">  <span class="keyword">having</span> <span class="keyword">count</span>(sc.cid)= (<span class="keyword">select</span> <span class="keyword">count</span>(cid) <span class="keyword">from</span> course)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h3 id="题型8"><a href="#题型8" class="headerlink" title="题型8"></a>题型8</h3><ol>
<li>查询至少有一门课与学号为” 01 “的同学所学相同的同学的信息</li>
</ol>
<p>思路：student表要和SC表作联合查询这是毫无疑问的，在查询时要多加一个限制条件“课程id要属于学号为” 01 “的同学所学的课程id集合”</p>
<p><strong>同理可以使用natural join，实质上natural join跟表联查是等价的。</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> student.* </span><br><span class="line"><span class="keyword">from</span> student,SC </span><br><span class="line"><span class="keyword">where</span> SC.cid <span class="keyword">in</span> (<span class="keyword">select</span> cid <span class="keyword">from</span> SC <span class="keyword">where</span> <span class="keyword">sid</span> = <span class="string">'01'</span>) <span class="keyword">and</span> student.sid=SC.sid;</span><br></pre></td></tr></table></figure>

<h3 id="题型9"><a href="#题型9" class="headerlink" title="题型9"></a>题型9</h3><ol>
<li>查询和” 01 “号的同学学习的课程完全相同的其他同学的信息</li>
</ol>
<p>这题本来不用写这么长但是由于这个操作：<strong>”取一个中间表的某字段最大的记录（即：top N问题）“</strong>使得这个查询变得很长，实际上没有这么长</p>
<p>分析：</p>
<p>首先取出sid为“01”的学生学习的所有课程的cid，这个应该不难</p>
<p>然后根据SC表中每个学生的每门成绩有且仅有一条记录这个原则：</p>
<ul>
<li>查询出SC中所有学生中有学习“01”学生学习的课程的记录</li>
<li>对上一条操作得到的中间表进行分组（根据sid），并计算count(cid)</li>
<li>如果某学生的count(cid)和”01“学生的count(cid)相同，则说明他们所学习的课程完全一样。同样的，如果某学生的count(cid)小于”01“学生的count(cid)，说明他学的课有和”01“学生相同的，但没有学完”01“学生学的所有课。如果某学生并不在这个查询结果内，说明他学的课没有一门是”01“学生学的课。</li>
<li>最后根据题目要求还要排除“01”学生这条记录</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> s.* <span class="keyword">from</span> </span><br><span class="line">student s,</span><br><span class="line">(<span class="keyword">select</span> * <span class="keyword">from</span> </span><br><span class="line">    (<span class="keyword">select</span> <span class="keyword">sid</span>,<span class="keyword">count</span>(cid) same_num <span class="keyword">from</span> SC </span><br><span class="line">        <span class="keyword">where</span> cid <span class="keyword">in</span> (<span class="keyword">select</span> cid <span class="keyword">from</span> SC <span class="keyword">where</span> <span class="keyword">sid</span> = <span class="string">'01'</span>) <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">sid</span>)</span><br><span class="line"><span class="keyword">where</span> same_num = (<span class="keyword">select</span> <span class="keyword">count</span>(cid) <span class="keyword">from</span> SC <span class="keyword">where</span> <span class="keyword">sid</span> =<span class="string">'01'</span>)) t</span><br><span class="line"><span class="keyword">where</span> s.sid =t.sid <span class="keyword">and</span> s.sid &lt;&gt; <span class="string">'01'</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> s.* <span class="keyword">from</span> </span><br><span class="line">student s,</span><br><span class="line">(<span class="keyword">select</span> <span class="keyword">sid</span> <span class="keyword">from</span> SC </span><br><span class="line">        <span class="keyword">where</span> cid <span class="keyword">in</span> (<span class="keyword">select</span> cid <span class="keyword">from</span> SC <span class="keyword">where</span> <span class="keyword">sid</span> = <span class="string">'01'</span>) <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">sid</span> <span class="keyword">having</span></span><br><span class="line"><span class="keyword">count</span>(cid) = (<span class="keyword">select</span> <span class="keyword">count</span>(cid) <span class="keyword">from</span> SC <span class="keyword">where</span> <span class="keyword">sid</span> =<span class="string">'01'</span>)) t</span><br><span class="line"><span class="keyword">where</span> s.sid =t.sid <span class="keyword">and</span> s.sid &lt;&gt; <span class="string">'01'</span>;</span><br></pre></td></tr></table></figure>

<h3 id="题型10"><a href="#题型10" class="headerlink" title="题型10"></a>题型10</h3><ol>
<li>查询没学过”张三”老师讲授的任一门课程的学生姓名</li>
</ol>
<p>这题思路跟<strong>题型7</strong>一样，要查没学过“张三”老师的课的学生，应该先查学过的，在求补集。如果直接求的话，会出现有人一门课都没学过的情况。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> student </span><br><span class="line"><span class="keyword">where</span> <span class="keyword">sid</span> <span class="keyword">not</span> <span class="keyword">in</span> (<span class="keyword">select</span>  <span class="keyword">sid</span> <span class="keyword">from</span> sc <span class="keyword">where</span> cid  <span class="keyword">in</span> </span><br><span class="line">(<span class="keyword">select</span> cid <span class="keyword">from</span> course <span class="keyword">where</span> tid = (<span class="keyword">select</span> tid <span class="keyword">from</span> teacher <span class="keyword">where</span> tname = <span class="string">'张三'</span>) ));</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> student</span><br><span class="line"><span class="keyword">where</span> student.sid <span class="keyword">not</span> <span class="keyword">in</span>(</span><br><span class="line">    <span class="keyword">select</span> sc.sid <span class="keyword">from</span> sc,course,teacher </span><br><span class="line">    <span class="keyword">where</span></span><br><span class="line">        sc.cid = course.cid</span><br><span class="line">        <span class="keyword">and</span> course.tid = teacher.tid</span><br><span class="line">        <span class="keyword">and</span> teacher.tname= <span class="string">"张三"</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h2 id="题组2"><a href="#题组2" class="headerlink" title="题组2"></a>题组2</h2><h3 id="题型1-1"><a href="#题型1-1" class="headerlink" title="题型1"></a>题型1</h3><ol>
<li>查询两门及其以上不及格课程的同学的学号，姓名及其平均成绩</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> s.sid 学号,s.sname 姓名,t2.avg_score 平均成绩 </span><br><span class="line"><span class="keyword">from</span> student s,</span><br><span class="line">(<span class="keyword">select</span> <span class="keyword">sid</span> <span class="keyword">from</span> sc <span class="keyword">where</span> score&lt;<span class="number">60</span> <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">sid</span> <span class="keyword">having</span> <span class="keyword">count</span>(cid)&gt;<span class="number">1</span>) t1,</span><br><span class="line">(<span class="keyword">select</span> <span class="keyword">sid</span>,<span class="keyword">avg</span>(score) avg_score <span class="keyword">from</span> sc <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">sid</span>) t2</span><br><span class="line"><span class="keyword">where</span> t1.sid = t2.sid <span class="keyword">and</span> s.sid = t1.sid;</span><br></pre></td></tr></table></figure>

<h3 id="题型2-1"><a href="#题型2-1" class="headerlink" title="题型2"></a>题型2</h3><ol>
<li>检索” 01 “课程分数小于 60，按分数降序排列的学生信息</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> student <span class="keyword">natural</span> <span class="keyword">join</span> sc </span><br><span class="line"><span class="keyword">where</span> score &lt;<span class="number">60</span> <span class="keyword">and</span> cid = <span class="string">'01'</span> </span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> score <span class="keyword">desc</span> ;</span><br></pre></td></tr></table></figure>

<h3 id="题型3-1"><a href="#题型3-1" class="headerlink" title="题型3"></a>题型3</h3><ol>
<li>按平均成绩从高到低显示所有学生的所有课程的成绩以及平均成绩</li>
</ol>
<p>此题本身难倒是不难，反而是如何显示要下一番功夫</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> (<span class="keyword">select</span> * <span class="keyword">from</span> sc </span><br><span class="line"><span class="keyword">union</span></span><br><span class="line">	<span class="keyword">select</span> <span class="keyword">sid</span>,<span class="string">'avg'</span> cid,<span class="keyword">avg</span>(score) score <span class="keyword">from</span> sc <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">sid</span>) </span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">sid</span>,<span class="keyword">case</span> <span class="keyword">when</span> cid = <span class="string">'avg'</span> <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span> <span class="keyword">asc</span>,score <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>

<h3 id="题型4-1"><a href="#题型4-1" class="headerlink" title="题型4"></a>题型4</h3><ol>
<li>查询各科成绩最高分、最低分和平均分：</li>
</ol>
<p>以如下形式显示：课程 ID，课程 name，最高分，最低分，平均分，及格率，中等率，优良率，优秀率</p>
<p>及格为&gt;=60，中等为：70-80，优良为：80-90，优秀为：&gt;=90</p>
<p>要求输出课程号和选修人数，查询结果按人数降序排列，若人数相同，按课程号升序排列</p>
<p><strong>这里没有查出课程名，如果要查的话natural join一下course表即可</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> </span><br><span class="line">cid 课程<span class="keyword">ID</span>,</span><br><span class="line"><span class="keyword">count</span>(*) 选修人数,</span><br><span class="line"><span class="keyword">max</span>(sc.score) 最高分,</span><br><span class="line"><span class="keyword">min</span>(sc.score) 最低分,</span><br><span class="line"><span class="keyword">AVG</span>(sc.score) 平均分,</span><br><span class="line"><span class="keyword">sum</span>(<span class="keyword">case</span> <span class="keyword">when</span> sc.score&gt;=<span class="number">60</span> <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span> )/<span class="keyword">count</span>(*) 及格率,</span><br><span class="line"><span class="keyword">sum</span>(<span class="keyword">case</span> <span class="keyword">when</span> sc.score&gt;=<span class="number">70</span> <span class="keyword">and</span> sc.score&lt;<span class="number">80</span> <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span> )/<span class="keyword">count</span>(*) 中等率,</span><br><span class="line"><span class="keyword">sum</span>(<span class="keyword">case</span> <span class="keyword">when</span> sc.score&gt;=<span class="number">80</span> <span class="keyword">and</span> sc.score&lt;<span class="number">90</span> <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span> )/<span class="keyword">count</span>(*) 优良率,</span><br><span class="line"><span class="keyword">sum</span>(<span class="keyword">case</span> <span class="keyword">when</span> sc.score&gt;=<span class="number">90</span> <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span> )/<span class="keyword">count</span>(*) 优秀率 </span><br><span class="line"><span class="keyword">from</span> sc</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> cid</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">count</span>(*) <span class="keyword">DESC</span>, cid <span class="keyword">ASC</span>;</span><br></pre></td></tr></table></figure>

<h3 id="题型5-1"><a href="#题型5-1" class="headerlink" title="题型5"></a>题型5</h3><ol>
<li>按各科成绩进行排序，并显示排名， Score 重复时保留名次空缺</li>
</ol>
<p>思路:</p>
<ul>
<li>首先查出比自己高分的记录有多少条，注意利用左连接的特点使得第一名（因为没有人比他高分，不使用左连接的话会没有第一名的记录比较麻烦）能被记录。</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> *</span><br><span class="line"><span class="keyword">from</span> sc  a </span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> sc  b </span><br><span class="line"><span class="keyword">on</span> a.score&lt;b.score <span class="keyword">and</span> a.cid = b.cid <span class="keyword">order</span> <span class="keyword">by</span> a.sid;</span><br></pre></td></tr></table></figure>

<ul>
<li>在得到的上表中，对于sid来说有多少条记录就说明排名是多少,但是因为需求是 <strong>Score 重复时保留名次空缺</strong>，因此不用<code>count(a.sid)</code>(或<code>count(a.cid)</code>,<code>count(a.score)</code>)而是使用<code>count(b.score)+1</code>,这样在计数比自己高的人数时就不会把自己算进去（因为使用的是<code>left join</code>,自己那一条记录的<code>b.score</code>是为<code>null</code> 的）</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> a.cid, a.sid, a.score, <span class="keyword">count</span>(b.score)+<span class="number">1</span>  <span class="keyword">rank</span></span><br><span class="line"><span class="keyword">from</span> sc  a </span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> sc  b </span><br><span class="line"><span class="keyword">on</span> a.score&lt;b.score <span class="keyword">and</span> a.cid = b.cid</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> a.cid, a.sid,a.score</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> a.cid, <span class="keyword">rank</span> <span class="keyword">ASC</span>;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>按各科成绩进行排序，并显示排名， Score 重复时不保留名次空缺</li>
</ol>
<p>此题与题型6的第2题情况一样</p>
<h3 id="题型6-1"><a href="#题型6-1" class="headerlink" title="题型6"></a>题型6</h3><ol>
<li>查询学生的总成绩，并进行排名，总分重复时保留名次空缺</li>
</ol>
<p>与题型5第1题解法类似</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> t.sid,t.score,<span class="keyword">count</span>(t2.score)+<span class="number">1</span> <span class="keyword">rank</span> </span><br><span class="line"><span class="keyword">from</span> (<span class="keyword">select</span> <span class="keyword">sid</span>,<span class="keyword">sum</span>(score) score <span class="keyword">from</span> sc <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">sid</span>) t </span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> (<span class="keyword">select</span> <span class="keyword">sid</span>,<span class="keyword">sum</span>(score) score <span class="keyword">from</span> sc <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">sid</span>) t2 </span><br><span class="line"><span class="keyword">on</span> t.score&lt;t2.score  </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> t.sid,t.score <span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">count</span>(*);</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>查询学生的总成绩，并进行排名，总分重复时不保留名次空缺</li>
</ol>
<p>这题没什么好思路，直接抄的别人的答案。在SQL里面变量用@来标识。但是在Oracle中的语法好像不是这样定义变量的，还是说应该使用plsql来解决？（下面是mysql的解法）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> @crank=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">select</span> q.sid, total, @crank := @crank +<span class="number">1</span> <span class="keyword">as</span> <span class="keyword">rank</span> <span class="keyword">from</span>(</span><br><span class="line"><span class="keyword">select</span> sc.sid, <span class="keyword">sum</span>(sc.score) <span class="keyword">as</span> total <span class="keyword">from</span> sc</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> sc.sid</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> total <span class="keyword">desc</span>)q;</span><br></pre></td></tr></table></figure>

<h3 id="题型7-1"><a href="#题型7-1" class="headerlink" title="题型7"></a>题型7</h3><ol>
<li>统计各科成绩各分数段人数：课程编号，课程名称，[100-85]，[85-70]，[70-60]，[60-0] 及所占百分比</li>
</ol>
<p>这里要注意<code>case when 条件 then 1 else 0 end</code>的原理，它是返回数值1或0，如果使用<code>count</code>来接收的话，不论是1还是0都会计数。效果跟<code>count(*)</code>一样，所以此处应该使用<code>sum</code>来计数，如果还不明白，将<code>sum(case when 条件 then 2 else 0 end)</code>和<code>count(case when 条件 then 2 else 0 end)</code>查询一下就明白了。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> cid,cname,</span><br><span class="line"><span class="keyword">sum</span>(<span class="keyword">case</span> <span class="keyword">when</span> score&gt;=<span class="number">85</span> <span class="keyword">and</span> score &lt;=<span class="number">100</span> <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>) <span class="string">"[100-85]人数"</span>,</span><br><span class="line"><span class="keyword">sum</span>(<span class="keyword">case</span> <span class="keyword">when</span> score&gt;=<span class="number">70</span> <span class="keyword">and</span> score &lt;<span class="number">85</span> <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>) <span class="string">"[85-70]人数"</span>,</span><br><span class="line"><span class="keyword">sum</span>(<span class="keyword">case</span> <span class="keyword">when</span> score&gt;=<span class="number">60</span> <span class="keyword">and</span> score &lt;<span class="number">70</span> <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>) <span class="string">"[70-60]人数"</span>,</span><br><span class="line"><span class="keyword">sum</span>(<span class="keyword">case</span> <span class="keyword">when</span> score&gt;=<span class="number">0</span> <span class="keyword">and</span> score &lt;<span class="number">60</span> <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>) <span class="string">"[60-0]人数"</span>,</span><br><span class="line"><span class="keyword">round</span>(<span class="keyword">sum</span>(<span class="keyword">case</span> <span class="keyword">when</span> score&gt;=<span class="number">85</span> <span class="keyword">and</span> score &lt;=<span class="number">100</span> <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>)/<span class="keyword">count</span>(*),<span class="number">2</span>) </span><br><span class="line">	<span class="string">"[100-85]比例"</span>,</span><br><span class="line"><span class="keyword">round</span>(<span class="keyword">sum</span>(<span class="keyword">case</span> <span class="keyword">when</span> score&gt;=<span class="number">70</span> <span class="keyword">and</span> score &lt;<span class="number">85</span> <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>)/<span class="keyword">count</span>(*),<span class="number">2</span>) </span><br><span class="line">	<span class="string">"[85-70]比例"</span>,</span><br><span class="line"><span class="keyword">round</span>(<span class="keyword">sum</span>(<span class="keyword">case</span> <span class="keyword">when</span> score&gt;=<span class="number">60</span> <span class="keyword">and</span> score &lt;<span class="number">70</span> <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>)/<span class="keyword">count</span>(*),<span class="number">2</span>) </span><br><span class="line">	<span class="string">"[70-60]比例"</span>,</span><br><span class="line"><span class="keyword">round</span>(<span class="keyword">sum</span>(<span class="keyword">case</span> <span class="keyword">when</span> score&gt;=<span class="number">0</span> <span class="keyword">and</span> score &lt;<span class="number">60</span> <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>)/<span class="keyword">count</span>(*),<span class="number">2</span>) </span><br><span class="line">	<span class="string">"[60-0]比例"</span></span><br><span class="line"><span class="keyword">from</span> sc <span class="keyword">natural</span> <span class="keyword">join</span> course <span class="keyword">group</span> <span class="keyword">by</span> cid,cname;</span><br></pre></td></tr></table></figure>

<h3 id="题型8-1"><a href="#题型8-1" class="headerlink" title="题型8"></a>题型8</h3><ol>
<li>查询各科成绩前三名的记录</li>
</ol>
<p>这个题目还是有点麻烦，因为Oracle不支持像mysql里面的<code>limit</code>语法。这里查询了一下资料，可以使用<code>OVER(PARTITION BY)</code>函数。附上一篇<a href="https://www.jianshu.com/p/e756a7d322f3" target="_blank" rel="noopener">讲解博客</a>。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> </span><br><span class="line">(<span class="keyword">select</span> sc.*,row_number() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> cid <span class="keyword">order</span> <span class="keyword">by</span> score <span class="keyword">desc</span>  ) <span class="keyword">rank</span> <span class="keyword">from</span> sc) </span><br><span class="line"><span class="keyword">where</span> <span class="keyword">rank</span> &lt; <span class="number">4</span>;</span><br></pre></td></tr></table></figure>

<p>但是上面的解法有个问题，如果有相同分数的就有点难办了。所以还是得用“找出比自己高分的人数”的思路来确定自己的排名。解法如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> sc</span><br><span class="line"><span class="keyword">where</span> (<span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">from</span> sc  a <span class="keyword">where</span> sc.cid = a.cid <span class="keyword">and</span> sc.score&lt;a.score )&lt; <span class="number">3</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> cid <span class="keyword">asc</span>, sc.score <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>

<h2 id="题组3"><a href="#题组3" class="headerlink" title="题组3"></a>题组3</h2><h3 id="题目1"><a href="#题目1" class="headerlink" title="题目1"></a>题目1</h3><ol>
<li>查询每门课程被选修的学生数</li>
</ol>
<p>查成绩单上每门课对应的记录条数即可。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> cid,<span class="keyword">count</span>(*) <span class="keyword">from</span> sc <span class="keyword">group</span> <span class="keyword">by</span> cid;</span><br></pre></td></tr></table></figure>

<h3 id="题目2"><a href="#题目2" class="headerlink" title="题目2"></a>题目2</h3><ol>
<li>查询出只选修两门课程的学生学号和姓名</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">sid</span>,sname <span class="keyword">from</span> sc <span class="keyword">natural</span> <span class="keyword">join</span> student <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">sid</span>,sname <span class="keyword">having</span> <span class="keyword">count</span>(*) =<span class="number">2</span>;</span><br></pre></td></tr></table></figure>

<h3 id="题目3"><a href="#题目3" class="headerlink" title="题目3"></a>题目3</h3><ol>
<li>查询男生、女生人数</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ssex 性别,<span class="keyword">count</span>(*) 人数  <span class="keyword">from</span> student <span class="keyword">group</span> <span class="keyword">by</span> ssex;</span><br></pre></td></tr></table></figure>

<h3 id="题目4"><a href="#题目4" class="headerlink" title="题目4"></a>题目4</h3><ol>
<li>查询名字中含有「风」字的学生信息</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> *<span class="keyword">from</span> student <span class="keyword">where</span> sname <span class="keyword">like</span> <span class="string">'%风%'</span>;</span><br></pre></td></tr></table></figure>

<h3 id="题目5"><a href="#题目5" class="headerlink" title="题目5"></a>题目5</h3><ol>
<li>查询同名同性学生名单，并统计同名人数</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  s1.sname 姓名,<span class="keyword">count</span>(*) 人数 <span class="keyword">from</span> </span><br><span class="line">student s1,student s2 </span><br><span class="line"><span class="keyword">where</span> s1.sid &lt;&gt; s2.sid <span class="keyword">and</span> s1.sname = s2.sname <span class="keyword">group</span> <span class="keyword">by</span> s1.sname;</span><br></pre></td></tr></table></figure>

<h3 id="题目6"><a href="#题目6" class="headerlink" title="题目6"></a>题目6</h3><ol>
<li>查询 1990 年出生的学生名单</li>
</ol>
<p>注：在Oracle里面没有<code>year()</code>函数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> student <span class="keyword">where</span> to_char(sage,<span class="string">'YYYY'</span>) = <span class="string">'1990'</span> ;</span><br></pre></td></tr></table></figure>

<h3 id="题目7"><a href="#题目7" class="headerlink" title="题目7"></a>题目7</h3><ol>
<li>查询每门课程的平均成绩，结果按平均成绩降序排列，平均成绩相同时，按课程编号升序排列</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> cname,cid,<span class="keyword">round</span>(<span class="keyword">avg</span>(score),<span class="number">2</span>) <span class="keyword">from</span> </span><br><span class="line">sc <span class="keyword">natural</span> <span class="keyword">join</span> course </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> cid,cname <span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">avg</span>(score) <span class="keyword">desc</span>,cid <span class="keyword">asc</span>;</span><br></pre></td></tr></table></figure>

<h3 id="题目8"><a href="#题目8" class="headerlink" title="题目8"></a>题目8</h3><ol>
<li>查询平均成绩大于等于 85 的所有学生的学号、姓名和平均成绩</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">sid</span>,sname,<span class="keyword">round</span>(<span class="keyword">avg</span>(score),<span class="number">2</span>) <span class="keyword">from</span> student <span class="keyword">natural</span> <span class="keyword">join</span> sc <span class="keyword">group</span> <span class="keyword">by</span> sname,<span class="keyword">sid</span> <span class="keyword">having</span> <span class="keyword">avg</span>(score) &gt;=<span class="number">85</span>;</span><br></pre></td></tr></table></figure>

<h3 id="题目9"><a href="#题目9" class="headerlink" title="题目9"></a>题目9</h3><ol>
<li>查询课程名称为「数学」，且分数低于 60 的学生姓名和分数</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> sname,score <span class="keyword">from</span> </span><br><span class="line">sc,course,student </span><br><span class="line"><span class="keyword">where</span> </span><br><span class="line">sc.cid = course.cid <span class="keyword">and</span> course.cname = <span class="string">'数学'</span> <span class="keyword">and</span> sc.sid = student.sid <span class="keyword">and</span> sc.score&lt;<span class="number">60</span>;</span><br></pre></td></tr></table></figure>

<h3 id="题目10"><a href="#题目10" class="headerlink" title="题目10"></a>题目10</h3><ol>
<li>查询所有学生的课程及分数情况（存在学生没成绩，没选课的情况）</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> student.sid,sname,cname,score <span class="keyword">from</span> </span><br><span class="line">student <span class="keyword">left</span> <span class="keyword">join</span> (<span class="keyword">select</span> * <span class="keyword">from</span> sc <span class="keyword">natural</span> <span class="keyword">join</span> course) t </span><br><span class="line"><span class="keyword">on</span> student.sid = t.sid;</span><br></pre></td></tr></table></figure>

<h2 id="题组4"><a href="#题组4" class="headerlink" title="题组4"></a>题组4</h2><h3 id="题目1-1"><a href="#题目1-1" class="headerlink" title="题目1"></a>题目1</h3><ol>
<li>查询任何一门课程成绩在 70 分以上的姓名、课程名称和分数</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> sname,cname,score <span class="keyword">from</span> </span><br><span class="line">student <span class="keyword">natural</span> <span class="keyword">join</span>  sc <span class="keyword">natural</span> <span class="keyword">join</span> course</span><br><span class="line"><span class="keyword">where</span> score&gt;<span class="number">70</span>;</span><br></pre></td></tr></table></figure>

<p>解法2：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> student.sname, course.cname,sc.score <span class="keyword">from</span> student,course,sc</span><br><span class="line"><span class="keyword">where</span> sc.score&gt;<span class="number">70</span></span><br><span class="line"><span class="keyword">and</span> student.sid = sc.sid</span><br><span class="line"><span class="keyword">and</span> sc.cid = course.cid;</span><br></pre></td></tr></table></figure>

<h3 id="题目2-1"><a href="#题目2-1" class="headerlink" title="题目2"></a>题目2</h3><ol>
<li>查询存在有人不及格的课程</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> cname <span class="keyword">from</span> sc <span class="keyword">natural</span> <span class="keyword">join</span> course <span class="keyword">where</span> score &lt; <span class="number">60</span>;</span><br></pre></td></tr></table></figure>

<h3 id="题目3-1"><a href="#题目3-1" class="headerlink" title="题目3"></a>题目3</h3><ol>
<li>查询课程编号为 01 且课程成绩在 80 分以上的学生的学号和姓名</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">sid</span>,sname <span class="keyword">from</span> sc <span class="keyword">natural</span> <span class="keyword">join</span> student <span class="keyword">where</span> score &gt;= <span class="number">80</span> <span class="keyword">and</span> cid = <span class="string">'01'</span>;</span><br></pre></td></tr></table></figure>

<h3 id="题目4-1"><a href="#题目4-1" class="headerlink" title="题目4"></a>题目4</h3><ol>
<li>求每门课程的学生人数</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> cname,<span class="keyword">count</span>(<span class="keyword">sid</span>) <span class="keyword">from</span> sc <span class="keyword">natural</span> <span class="keyword">join</span> course <span class="keyword">group</span> <span class="keyword">by</span> cname;</span><br></pre></td></tr></table></figure>

<h3 id="题目5-1"><a href="#题目5-1" class="headerlink" title="题目5"></a>题目5</h3><ol>
<li>成绩不重复，查询选修「张三」老师所授课程的学生中，成绩最高的学生信息及其成绩</li>
</ol>
<p>要注意一个老师是可以有多门课的，这里的数据恰好是只有一门课。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> student.*,t.* <span class="keyword">from</span> </span><br><span class="line">sc ,</span><br><span class="line">student,</span><br><span class="line">(<span class="keyword">select</span> cid,<span class="keyword">max</span>(score) score  <span class="keyword">from</span> sc </span><br><span class="line"> 	<span class="keyword">where</span> cid </span><br><span class="line"> 	<span class="keyword">in</span>(<span class="keyword">select</span> cid <span class="keyword">from</span> course <span class="keyword">natural</span> <span class="keyword">join</span> teacher <span class="keyword">where</span> tname =<span class="string">'张三'</span>) <span class="keyword">group</span> <span class="keyword">by</span> cid) t</span><br><span class="line"><span class="keyword">where</span> sc.sid = student.sid <span class="keyword">and</span> sc.cid = t.cid <span class="keyword">and</span> sc.score = t.score;</span><br></pre></td></tr></table></figure>

<h3 id="题目6-1"><a href="#题目6-1" class="headerlink" title="题目6"></a>题目6</h3><ol start="2">
<li>查询不同课程成绩相同的学生的学生编号、课程编号、学生成绩</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> t1.* <span class="keyword">from</span> sc t1 <span class="keyword">inner</span> <span class="keyword">join</span> sc t2 </span><br><span class="line"><span class="keyword">on</span> t1.cid = t2.cid <span class="keyword">and</span> t1.score = t2.score <span class="keyword">and</span> t1.sid &lt;&gt; t2.sid <span class="keyword">order</span> <span class="keyword">by</span> t1.cid;</span><br></pre></td></tr></table></figure>

<h3 id="题目7-1"><a href="#题目7-1" class="headerlink" title="题目7"></a>题目7</h3><ol>
<li>查询每门课成绩排名前2的学生</li>
</ol>
<p>这题在Oracle里面还是比较麻烦，解题思路跟<strong>题组2 题型5</strong>差不多</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> t1.cid,t1.sid,<span class="keyword">count</span>(*) <span class="keyword">from</span> </span><br><span class="line">sc t1 <span class="keyword">left</span> <span class="keyword">join</span> sc t2 <span class="keyword">on</span> </span><br><span class="line">t2.score&gt;t1.score <span class="keyword">and</span> t1.sid &lt;&gt; t2.sid <span class="keyword">and</span> t1.cid = t2.cid  </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> t1.cid,t1.sid <span class="keyword">having</span> <span class="keyword">count</span>(*)&lt;=<span class="number">2</span> <span class="keyword">order</span> <span class="keyword">by</span> cid;</span><br></pre></td></tr></table></figure>

<h3 id="题目8-1"><a href="#题目8-1" class="headerlink" title="题目8"></a>题目8</h3><ol>
<li>统计每门课程的学生选修人数（超过 5 人的课程才统计）</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> cid,<span class="keyword">count</span>(*) <span class="keyword">from</span> sc <span class="keyword">group</span> <span class="keyword">by</span> cid <span class="keyword">having</span> <span class="keyword">count</span>(*) &gt;<span class="number">5</span>;</span><br></pre></td></tr></table></figure>

<h3 id="题目9-1"><a href="#题目9-1" class="headerlink" title="题目9"></a>题目9</h3><ol>
<li>检索至少选修两门课程的学生学号</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">sid</span>  <span class="keyword">from</span> sc <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">sid</span> <span class="keyword">having</span> <span class="keyword">count</span>(cid) &gt;=<span class="number">2</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">sid</span>;</span><br></pre></td></tr></table></figure>

<h3 id="题目10-1"><a href="#题目10-1" class="headerlink" title="题目10"></a>题目10</h3><ol>
<li>查询选修了全部课程的学生信息</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> student <span class="keyword">where</span> <span class="keyword">sid</span> <span class="keyword">in</span> </span><br><span class="line">(<span class="keyword">select</span> <span class="keyword">sid</span> <span class="keyword">from</span> sc <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">sid</span> <span class="keyword">having</span> <span class="keyword">count</span>(cid) =(<span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">from</span> course));</span><br></pre></td></tr></table></figure>

<h2 id="题组5"><a href="#题组5" class="headerlink" title="题组5"></a>题组5</h2><h3 id="题目1-2"><a href="#题目1-2" class="headerlink" title="题目1"></a>题目1</h3><ol>
<li>查询各学生的年龄，只按年份来算</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> sname,<span class="keyword">round</span>(months_between(<span class="keyword">sysdate</span>,sage)/<span class="number">12</span>,<span class="number">0</span>) 年龄 <span class="keyword">from</span> student;</span><br></pre></td></tr></table></figure>

<h3 id="题目2-2"><a href="#题目2-2" class="headerlink" title="题目2"></a>题目2</h3><ol>
<li>查询本周过生日的学生</li>
</ol>
<p>在oracle里面貌似比较难实现…</p>
<p>思路：首先将出生日期的年份替换为当前年份，然后看这个日期是今年的第几周，是否与当前时间是当前第几周相同。（感觉解法是错的…有待研究）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">sid</span>  <span class="keyword">from</span> student <span class="keyword">where</span> </span><br><span class="line">to_char(add_months(sage,(to_char(<span class="keyword">sysdate</span>,<span class="string">'yyyy'</span>) - to_char(sage,<span class="string">'yyyy'</span>))*<span class="number">12</span>),<span class="string">'ww'</span>) = </span><br><span class="line">to_char(<span class="keyword">sysdate</span>,<span class="string">'ww'</span>);</span><br></pre></td></tr></table></figure>

<h3 id="题目3-2"><a href="#题目3-2" class="headerlink" title="题目3"></a>题目3</h3><ol>
<li>查询下周过生日的学生</li>
</ol>
<p>这题要考虑边界情况，如果下周是下一年了就比较难搞了…（有待研究）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="题目4-2"><a href="#题目4-2" class="headerlink" title="题目4"></a>题目4</h3><ol>
<li>查询本月过生日的学生</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> student <span class="keyword">where</span> to_char(<span class="keyword">sysdate</span>,<span class="string">'MM'</span>) = to_char(sage,<span class="string">'MM'</span>);</span><br></pre></td></tr></table></figure>

<h3 id="题目5-2"><a href="#题目5-2" class="headerlink" title="题目5"></a>题目5</h3><ol>
<li>查询下月过生日的学生</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> student <span class="keyword">where</span> <span class="keyword">MOD</span>(to_char(<span class="keyword">sysdate</span>,<span class="string">'MM'</span>)+<span class="number">1</span>,<span class="number">13</span>)= to_char(sage,<span class="string">'MM'</span>);</span><br></pre></td></tr></table></figure>


        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    最后更新时间：<time datetime="2020-04-07T03:14:27.203Z" itemprop="dateUpdated">2020-04-07 11:14:27</time>
</span><br>


        
    </div>
    
    <footer>
        <a href="http://lipan.fun">
            <img src="/img/morty.jpg" alt="lipan">
            lipan
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Oracle/">Oracle</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SQL/">SQL</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数据库/">数据库</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://lipan.fun/2020/03/20/50道sql练习题/&title=《50道sql练习题》 — 今天你进步了吗&pic=http://lipan.fun/img/morty.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://lipan.fun/2020/03/20/50道sql练习题/&title=《50道sql练习题》 — 今天你进步了吗&source=java spring 算法 springboot web" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://lipan.fun/2020/03/20/50道sql练习题/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《50道sql练习题》 — 今天你进步了吗&url=http://lipan.fun/2020/03/20/50道sql练习题/&via=http://lipan.fun" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://lipan.fun/2020/03/20/50道sql练习题/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2020/04/02/Java多线程基础/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">Java多线程基础</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2019/11/05/多个串的公共子序列/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">多个串的公共子序列</h4>
      </a>
    </div>
  
</nav>



    




















    <section class="comments" id="comments">
    <div id="giteement-ctn"></div>
    
        <link rel="stylesheet" href="/css/gitee.css">
        <script src="/js/giteement.browser.js"></script>
    
    
    <script>
    var giteement = new Giteement({
		id: '20200320235136',
        owner: 'drunkShrimper',
        repo: 'blog-comment',
        backcall_uri: 'https://lipan.fun',
        oauth_uri: 'https://cors-anywhere.herokuapp.com/https://gitee.com/oauth/token',
        oauth: {
        client_id: '50cc1ebe038c970cd39a42973eb8fbbba8d36dae7825175e8b483e5cb42b1ff8',
        client_secret: '94d17fef3422b646b2635d4c65289345e66cbae0ccf05c6c79c960a4c679e72f'
    },
    })
    giteement.render('giteement-ctn')
    </script>
    </section>



</article>



</div>

        <footer class="footer">
    <div class="bottom">
        <p>
			<span> 2019 - 2020</span>
            <span>
                
                <a href="http://www.beian.miit.gov.cn/" target="_blank" style="text-decoration:none;">粤ICP备20019675号-1</a>
                
            </span>
			<span>
				<a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=44178102001155" style="display:inline-block;text-decoration:none;height:20px;line-height:20px;">
					<img src="/img/gov.png" style="float:left;"/>
					&nbsp;粤公网安备 44178102001155号
				</a>
			</span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://lipan.fun/2020/03/20/50道sql练习题/&title=《50道sql练习题》 — 今天你进步了吗&pic=http://lipan.fun/img/morty.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://lipan.fun/2020/03/20/50道sql练习题/&title=《50道sql练习题》 — 今天你进步了吗&source=java spring 算法 springboot web" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://lipan.fun/2020/03/20/50道sql练习题/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《50道sql练习题》 — 今天你进步了吗&url=http://lipan.fun/2020/03/20/50道sql练习题/&via=http://lipan.fun" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://lipan.fun/2020/03/20/50道sql练习题/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACMElEQVR42u3awY6DMAxF0f7/TzPSbDuE+2xaDc7NCrWh5FDJsp28Xngcv+P9ej3/bObxNshdNwwZMmQ8lnEsB1/62VLW1/yTs7XJkCFjHwYJsvwBBMOfu54jQ4YMGXwR/USQB3oZMmTIqIXINKWTIUOGjJTBH5mmjGkj7+O1uAwZMh7I6GwMfPr6S/sbMmTI+MeMIxy8Kcbv6g8ZMmTMZqwXQUrHNGXk0TL9HRkyZExlFBtbjXBZ28K8SBZlyJCxDYP/XC0skgXxOTJkyNiTkR6t4C+Cvw6Sql6UrzJkyBjH4JuO60d2ksLONucf/4kMGTJGM9JwWTsM0Wr9rwtvGTJkbMlI60S+edBJDVGeK0OGjNGMziLWn9eSv6AxJ0OGjKGM9SN524u06mrbBqgJKEOGjI0ZtbKTBFYyMziIJkOGjA0YvHQkYZQHX97ICxptMmTIGMfg6VdtTq3Rn26jypAhYwdGbQOgeCQCJJ388Fnxn5EhQ8YDGZ2DEXcdziAvK0gNZciQMYhBHhwfegjL19qc+PyaDBkyHs5IW/n91lgaiC/WLEOGjNGMWhjlWwj9QrfYNZQhQ8YgRu0gBS9EO0fBglcpQ4aM0Qw++k20WqnM75IhQ8ZsBg+yPKHsbwDEa5AhQ8YGjLTg5Euphd006MuQIUMGCZcpNS2kA6UMGTK2Z3QKV/JtLXzLkCFjB0a6rNo2JG+3pQc4ZMiQMZuRFpCdrKxTMN+w1yFDhoznMX4ADxpW5Ip7egUAAAAASUVORK5CYII=" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };


</script>

<script src="/js/main.min.js?v=1.7.2"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="/js/search.min.js?v=1.7.2" async></script>








<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '今天你进步了吗';
            clearTimeout(titleTime);
        } else {
            document.title = '今天你进步了吗';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
